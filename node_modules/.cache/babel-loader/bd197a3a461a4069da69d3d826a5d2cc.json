{"ast":null,"code":"var _jsxFileName = \"/Users/vitaliy/Documents/GitHub/React-Courses/src/pages/News/News.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport { fetchArticles } from '../../services/ApiService';\nimport { NewSearchFormHooks } from './components/NewSearchForm';\nimport { Pending } from './components/state/Pending';\nimport { Rejected } from './components/state/Rejected';\nimport { Idle } from './components/state/Idle';\nimport { Resolved } from './components/state/Resolved';\nimport { NewsContainer } from './styles/News.styled.jsx';\nimport { useLocalStorage } from 'hooks';\nimport { themeContext } from 'context/authContext';\nimport { useSearchParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Status = {\n  IDLE: 'idle',\n  PENDING: 'pending',\n  REJECTED: 'rejected',\n  RESOLVED: 'resolved'\n};\n\nfunction News() {\n  _s();\n\n  const [articles, setArticles] = useLocalStorage('articles', []);\n  const [currentPage, setCurrentPage] = useLocalStorage('currentPage', 1);\n  const [status, setStatus] = useState(Status.IDLE);\n  const {\n    mainTheme\n  } = useContext(themeContext);\n  const [searchParams, setSearchParams] = useSearchParams();\n  useEffect(() => {\n    const abortController = new AbortController();\n\n    function mergeArrayUnique(arr1, arr2) {\n      const reduced = arr1.filter(function (obj1) {\n        return !arr2.find(function (obj2) {\n          return obj1.url === obj2.url;\n        });\n      });\n      return reduced.concat(arr2);\n    }\n\n    ;\n    const paramsSearch = searchParams.get('search');\n    const numberedCurrentPage = Number(currentPage);\n    const options = {\n      searchQuery: paramsSearch,\n      numberedCurrentPage\n    };\n    setStatus(Status.PENDING);\n\n    try {\n      fetchArticles(options, abortController).then(articles => {\n        setArticles(prevArticles => [...mergeArrayUnique(prevArticles, articles)]);\n        setStatus(Status.RESOLVED);\n      });\n    } catch (error) {\n      setStatus(Status.REJECTED);\n    }\n\n    return () => {\n      abortController.abort();\n    };\n  }, [currentPage, setArticles, setSearchParams, searchParams]); // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  useEffect(() => {\n    if (currentPage !== 1) {\n      window.localStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [currentPage]);\n  useEffect(() => {\n    if (articles.length > 0) {\n      window.localStorage.setItem('articles', JSON.stringify(articles));\n    }\n  }, [articles]); // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  const updatePage = () => {\n    setCurrentPage(prevPage => prevPage + 1);\n  };\n\n  const onChangeQuery = query => {\n    setSearchParams({\n      search: query\n    });\n    setCurrentPage(1);\n    setArticles([]);\n  };\n\n  const shouldRenderLoadMoreButton = articles.length > 0 && status === 'resolved';\n  return /*#__PURE__*/_jsxDEV(NewsContainer, {\n    colors: mainTheme.colors,\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"News By Hooks\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), status === 'idle' && /*#__PURE__*/_jsxDEV(Idle, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 29\n    }, this), status === 'rejected' && /*#__PURE__*/_jsxDEV(Rejected, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 33\n    }, this), /*#__PURE__*/_jsxDEV(NewSearchFormHooks, {\n      onSubmit: onChangeQuery\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), status === 'resolved' && /*#__PURE__*/_jsxDEV(Resolved, {\n      articles: articles,\n      shouldRenderLoadMoreButton: shouldRenderLoadMoreButton,\n      onClick: updatePage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }, this), status === 'pending' && /*#__PURE__*/_jsxDEV(Pending, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 32\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n}\n\n_s(News, \"4PjlONoRpjHMylpe3nhFLXuJTIs=\", false, function () {\n  return [useLocalStorage, useLocalStorage, useSearchParams];\n});\n\n_c = News;\n;\nexport default News;\n\nvar _c;\n\n$RefreshReg$(_c, \"News\");","map":{"version":3,"sources":["/Users/vitaliy/Documents/GitHub/React-Courses/src/pages/News/News.jsx"],"names":["React","useState","useEffect","useContext","fetchArticles","NewSearchFormHooks","Pending","Rejected","Idle","Resolved","NewsContainer","useLocalStorage","themeContext","useSearchParams","Status","IDLE","PENDING","REJECTED","RESOLVED","News","articles","setArticles","currentPage","setCurrentPage","status","setStatus","mainTheme","searchParams","setSearchParams","abortController","AbortController","mergeArrayUnique","arr1","arr2","reduced","filter","obj1","find","obj2","url","concat","paramsSearch","get","numberedCurrentPage","Number","options","searchQuery","then","prevArticles","error","abort","window","localStorage","setItem","JSON","stringify","length","updatePage","prevPage","onChangeQuery","query","search","shouldRenderLoadMoreButton","colors"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { fetchArticles } from '../../services/ApiService';\nimport { NewSearchFormHooks } from './components/NewSearchForm';\n\nimport { Pending } from './components/state/Pending';\nimport { Rejected } from './components/state/Rejected';\nimport { Idle } from './components/state/Idle';\nimport { Resolved } from './components/state/Resolved';\nimport { NewsContainer } from './styles/News.styled.jsx';\n\nimport { useLocalStorage } from 'hooks';\n\nimport { themeContext } from 'context/authContext';\nimport { useSearchParams } from 'react-router-dom';\n\nconst Status = {\n  IDLE: 'idle',\n  PENDING: 'pending',\n  REJECTED: 'rejected',\n  RESOLVED: 'resolved',\n};\n\nfunction News() {\n  const [articles, setArticles] = useLocalStorage('articles', []);\n  const [currentPage, setCurrentPage] = useLocalStorage('currentPage', 1);\n  const [status, setStatus] = useState(Status.IDLE);\n\n  const { mainTheme } = useContext(themeContext);\n\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  useEffect(() => {\n    const abortController = new AbortController();\n\n    function mergeArrayUnique(arr1, arr2) {\n      const reduced = arr1.filter(function (obj1) {\n        return !arr2.find(function (obj2) {\n          return obj1.url === obj2.url;\n        });\n      });\n      return reduced.concat(arr2);\n    };\n\n    const paramsSearch = searchParams.get('search');\n\n    const numberedCurrentPage = Number(currentPage);\n    const options = { searchQuery: paramsSearch, numberedCurrentPage };\n    setStatus(Status.PENDING);\n    try {\n      fetchArticles(options, abortController).then(articles => {\n        setArticles(prevArticles => [\n          ...mergeArrayUnique(prevArticles, articles),\n        ]);\n        setStatus(Status.RESOLVED);\n      });\n    } catch (error) {\n      setStatus(Status.REJECTED);\n    }\n    return () => {\n      abortController.abort();\n    };\n  }, [currentPage, setArticles, setSearchParams, searchParams]);\n\n  // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  useEffect(() => {\n    if (currentPage !== 1) {\n      window.localStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [currentPage]);\n\n  useEffect(() => {\n    if (articles.length > 0) {\n      window.localStorage.setItem('articles', JSON.stringify(articles));\n    }\n  }, [articles]);\n\n  // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  const updatePage = () => {\n    setCurrentPage(prevPage => prevPage + 1);\n  };\n\n  const onChangeQuery = query => {\n    setSearchParams({search: query});\n    setCurrentPage(1);\n    setArticles([]);\n  };\n\n  const shouldRenderLoadMoreButton =\n    articles.length > 0 && status === 'resolved';\n\n  return (\n    <NewsContainer colors={mainTheme.colors}>\n      <h1>News By Hooks</h1>\n      {status === 'idle' && <Idle />}\n      {status === 'rejected' && <Rejected />}\n      <NewSearchFormHooks onSubmit={onChangeQuery} />\n      {status === 'resolved' && (\n        <Resolved\n          articles={articles}\n          shouldRenderLoadMoreButton={shouldRenderLoadMoreButton}\n          onClick={updatePage}\n        />\n      )}\n      {status === 'pending' && <Pending />}\n    </NewsContainer>\n  );\n};\n\n\nexport default News;\n"]},"metadata":{},"sourceType":"module"}