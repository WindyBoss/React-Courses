{"ast":null,"code":"var _jsxFileName = \"/Users/vitaliy/Documents/GitHub/React-Courses/src/pages/News.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { Component, useState, useEffect } from 'react';\nimport { fetchArticles } from '../components/News/ApiService';\nimport { NewSearchFormClass, NewSearchFormHooks } from '../components/News/NewSearchForm';\nimport { Pending } from '../components/News/Pending';\nimport { Rejected } from '../components/News/Rejected';\nimport { Idle } from '../components/News/Idle';\nimport { Resolved } from '../components/News/Resolved';\nimport { NewsContainer } from '../components/News/News.styled.jsx';\nimport { useLocalStorage } from '../Hooks/useLocalStorage';\nimport { themeContext } from \"context/authContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Status = {\n  IDLE: 'idle',\n  PENDING: 'pending',\n  REJECTED: 'rejected',\n  RESOLVED: 'resolved'\n};\n\nclass NewsClass extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      articles: [],\n      currentPage: 1,\n      searchQuery: '',\n      status: Status.IDLE\n    };\n    this.abortController = new AbortController();\n\n    this.onChangeQuery = query => {\n      this.setState({\n        searchQuery: query,\n        currentPage: 1,\n        articles: []\n      });\n    };\n\n    this.fetchData = async () => {\n      const {\n        currentPage,\n        searchQuery\n      } = this.state;\n      const options = {\n        searchQuery,\n        currentPage\n      };\n      this.setState({\n        status: Status.PENDING\n      });\n\n      try {\n        await fetchArticles(options, this.abortController).then(articles => {\n          this.setState(prevState => ({\n            articles: [...prevState.articles, ...articles],\n            currentPage: prevState.currentPage + 1,\n            status: Status.RESOLVED\n          }));\n        });\n      } catch (error) {\n        this.setState({\n          status: Status.REJECTED\n        });\n      }\n    };\n  }\n\n  componentDidUpdate(_, prevState) {\n    if (prevState.searchQuery !== this.state.searchQuery) {\n      this.fetchData();\n    }\n\n    ;\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    const {\n      articles,\n      status\n    } = this.state;\n    const shouldRenderLoadMoreButton = articles.length > 0 && status === 'resolved';\n    console.log(articles);\n    console.log(this.state.currentPage);\n    return /*#__PURE__*/_jsxDEV(themeContext.Consumer, {\n      children: _ref => {\n        let {\n          mainTheme\n        } = _ref;\n        return /*#__PURE__*/_jsxDEV(NewsContainer, {\n          colors: mainTheme.colors,\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"News By Class\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 9\n          }, this), status === 'idle' && /*#__PURE__*/_jsxDEV(Idle, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 31\n          }, this), status === 'rejected' && /*#__PURE__*/_jsxDEV(Rejected, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 35\n          }, this), /*#__PURE__*/_jsxDEV(NewSearchFormClass, {\n            onSubmit: this.onChangeQuery\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 9\n          }, this), status === 'resolved' && /*#__PURE__*/_jsxDEV(Resolved, {\n            articles: articles,\n            shouldRenderLoadMoreButton: shouldRenderLoadMoreButton,\n            onClick: this.fetchData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 35\n          }, this), status === 'pending' && /*#__PURE__*/_jsxDEV(Pending, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 7\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\n; // console.log(`difference between || & ?? the same value in brackets, but different results (undefined XXX 1) ====> || = ${undefined || 1} && ?? = ${undefined ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (null XXX 1) ====> || = ${null || 1} && ?? = ${null ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (0 XXX 1) ====> || = ${0 || 1} && ?? = ${0 ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (false XXX true) ====> || = ${false || true} && ?? = ${false ?? true}`)\n\n/*\n* Let's add local storage to our app\n*/\n\nfunction NewsHooks() {\n  _s();\n\n  const [articles, setArticles] = useLocalStorage('articles', []);\n  const [currentPage, setCurrentPage] = useLocalStorage('currentPage', 1);\n  const [searchQuery, setSearchQuery] = useLocalStorage('searchQuery', '');\n  const [status, setStatus] = useState(Status.IDLE);\n  useEffect(() => {\n    const abortController = new AbortController();\n\n    if (!searchQuery || searchQuery === '') {\n      return;\n    }\n\n    ;\n\n    function mergeArrayUnique(arr1, arr2) {\n      const reduced = arr1.filter(function (obj1) {\n        return !arr2.find(function (obj2) {\n          return obj1.url === obj2.url;\n        });\n      });\n      return reduced.concat(arr2);\n    }\n\n    ;\n    const numberedCurrentPage = Number(currentPage);\n    const options = {\n      searchQuery,\n      numberedCurrentPage\n    };\n    setStatus(Status.PENDING);\n\n    try {\n      fetchArticles(options, abortController).then(articles => {\n        setArticles(prevArticles => [...mergeArrayUnique(prevArticles, articles)]);\n        setStatus(Status.RESOLVED);\n      });\n    } catch (error) {\n      setStatus(Status.REJECTED);\n    }\n\n    ;\n    return () => {\n      abortController.abort();\n    };\n  }, [searchQuery, currentPage, setArticles]); // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  useEffect(() => {\n    if (searchQuery !== '') {\n      window.localStorage.setItem('searchQuery', JSON.stringify(searchQuery));\n    }\n  }, [searchQuery]);\n  useEffect(() => {\n    if (currentPage !== 1) {\n      window.localStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n\n    ;\n  }, [currentPage]);\n  useEffect(() => {\n    if (articles.length > 0) {\n      window.localStorage.setItem('articles', JSON.stringify(articles));\n    }\n  }, [articles]); // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  const updatePage = () => {\n    setCurrentPage(prevPage => prevPage + 1);\n  };\n\n  const onChangeQuery = query => {\n    setSearchQuery(query);\n    setCurrentPage(1);\n    setArticles([]);\n  };\n\n  const shouldRenderLoadMoreButton = articles.length > 0 && status === 'resolved';\n  return /*#__PURE__*/_jsxDEV(themeContext.Consumer, {\n    children: _ref2 => {\n      let {\n        mainTheme\n      } = _ref2;\n      return /*#__PURE__*/_jsxDEV(NewsContainer, {\n        colors: mainTheme.colors,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"News By Hooks\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 5\n        }, this), status === 'idle' && /*#__PURE__*/_jsxDEV(Idle, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 29\n        }, this), status === 'rejected' && /*#__PURE__*/_jsxDEV(Rejected, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 33\n        }, this), /*#__PURE__*/_jsxDEV(NewSearchFormHooks, {\n          onSubmit: onChangeQuery\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 7\n        }, this), status === 'resolved' && /*#__PURE__*/_jsxDEV(Resolved, {\n          articles: articles,\n          shouldRenderLoadMoreButton: shouldRenderLoadMoreButton,\n          onClick: updatePage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 33\n        }, this), status === 'pending' && /*#__PURE__*/_jsxDEV(Pending, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 32\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 5\n      }, this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 178,\n    columnNumber: 5\n  }, this);\n}\n\n_s(NewsHooks, \"P1VoF77+GVH+u80wfHGXZgS0fFw=\", false, function () {\n  return [useLocalStorage, useLocalStorage, useLocalStorage];\n});\n\n_c = NewsHooks;\n;\nexport function News() {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    children: [/*#__PURE__*/_jsxDEV(NewsClass, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NewsHooks, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 5\n  }, this);\n}\n_c2 = News;\n;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"NewsHooks\");\n$RefreshReg$(_c2, \"News\");","map":{"version":3,"sources":["/Users/vitaliy/Documents/GitHub/React-Courses/src/pages/News.jsx"],"names":["React","Component","useState","useEffect","fetchArticles","NewSearchFormClass","NewSearchFormHooks","Pending","Rejected","Idle","Resolved","NewsContainer","useLocalStorage","themeContext","Status","IDLE","PENDING","REJECTED","RESOLVED","NewsClass","state","articles","currentPage","searchQuery","status","abortController","AbortController","onChangeQuery","query","setState","fetchData","options","then","prevState","error","componentDidUpdate","_","componentWillUnmount","abort","render","shouldRenderLoadMoreButton","length","console","log","mainTheme","colors","NewsHooks","setArticles","setCurrentPage","setSearchQuery","setStatus","mergeArrayUnique","arr1","arr2","reduced","filter","obj1","find","obj2","url","concat","numberedCurrentPage","Number","prevArticles","window","localStorage","setItem","JSON","stringify","updatePage","prevPage","News","display","justifyContent"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect } from 'react';\nimport { fetchArticles } from '../components/News/ApiService';\nimport { NewSearchFormClass, NewSearchFormHooks } from '../components/News/NewSearchForm';\n\nimport { Pending } from '../components/News/Pending';\nimport { Rejected } from '../components/News/Rejected';\nimport { Idle } from '../components/News/Idle';\nimport { Resolved } from '../components/News/Resolved';\nimport { NewsContainer } from '../components/News/News.styled.jsx';\n\nimport { useLocalStorage } from '../Hooks/useLocalStorage';\n\nimport { themeContext } from \"context/authContext\";\n\n\nconst Status = {\n  IDLE: 'idle',\n  PENDING: 'pending',\n  REJECTED: 'rejected',\n  RESOLVED: 'resolved',\n};\n\nclass NewsClass extends Component {\n  state = {\n    articles: [],\n    currentPage: 1,\n    searchQuery: '',\n    status: Status.IDLE,\n  };\n\n  abortController = new AbortController();\n\n  componentDidUpdate(_, prevState) {\n    if(prevState.searchQuery !== this.state.searchQuery) {\n      this.fetchData();\n    };\n  };\n\n  onChangeQuery = query => {\n    this.setState({\n      searchQuery: query,\n      currentPage: 1,\n      articles: [],\n    });\n  };\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  fetchData = async () => {\n    const { currentPage, searchQuery } = this.state;\n    const options = { searchQuery, currentPage };\n    this.setState({ status: Status.PENDING });\n\n    try {\n      await fetchArticles(options, this.abortController)\n      .then((articles) => {\n      this.setState(prevState => ({\n        articles: [...prevState.articles, ...articles],\n        currentPage: prevState.currentPage + 1,\n        status: Status.RESOLVED,\n      }));\n    })\n    } catch (error) {\n      this.setState({ status: Status.REJECTED })\n    }\n  };\n\n  render() {\n    const { articles, status } = this.state;\n    const shouldRenderLoadMoreButton = articles.length > 0 && status === 'resolved';\n    console.log(articles);\n    console.log(this.state.currentPage);\n\n    return (\n      <themeContext.Consumer>\n      {({mainTheme}) => (  \n      <NewsContainer colors={mainTheme.colors}>\n        <h1>News By Class</h1>\n        {status === 'idle' && <Idle/>}\n        {status === 'rejected' && <Rejected/>}\n        <NewSearchFormClass onSubmit={this.onChangeQuery} />\n        {status === 'resolved' && <Resolved articles={articles} shouldRenderLoadMoreButton={shouldRenderLoadMoreButton} onClick={this.fetchData}/>}\n        {status === 'pending' && <Pending/>}\n      </NewsContainer>\n      )}\n      </themeContext.Consumer>      \n    );\n  };\n};\n\n// console.log(`difference between || & ?? the same value in brackets, but different results (undefined XXX 1) ====> || = ${undefined || 1} && ?? = ${undefined ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (null XXX 1) ====> || = ${null || 1} && ?? = ${null ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (0 XXX 1) ====> || = ${0 || 1} && ?? = ${0 ?? 1}`)\n// console.log(`difference between || & ?? the same value in brackets, but different results (false XXX true) ====> || = ${false || true} && ?? = ${false ?? true}`)\n\n/*\n* Let's add local storage to our app\n*/\n\nfunction NewsHooks() {\n  const [articles, setArticles] = useLocalStorage('articles', []);\n  const [currentPage, setCurrentPage] = useLocalStorage('currentPage', 1);\n  const [searchQuery, setSearchQuery] = useLocalStorage('searchQuery', '');\n  const [status, setStatus] = useState(Status.IDLE);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n\n    if (!searchQuery || searchQuery === '') {\n      return;\n    };\n\n    function mergeArrayUnique(arr1, arr2) {\n      const reduced = arr1.filter(function(obj1) {\n        return !arr2.find(function(obj2) {\n          return obj1.url === obj2.url;\n        });\n      });\n      return reduced.concat(arr2);\n    };\n\n    const numberedCurrentPage = Number(currentPage);\n    const options = { searchQuery, numberedCurrentPage };\n    setStatus(Status.PENDING);\n    try {\n      fetchArticles(options, abortController)\n        .then((articles) => {\n          setArticles(prevArticles => [...mergeArrayUnique(prevArticles, articles)]);\n          setStatus(Status.RESOLVED);\n         })\n    } catch (error) {\n      setStatus(Status.REJECTED);\n    };\n    return () => {\n      abortController.abort();\n    };\n  }, [searchQuery, currentPage, setArticles]);\n\n  // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  useEffect(() => {\n    if (searchQuery !== '') {\n      window.localStorage.setItem('searchQuery', JSON.stringify(searchQuery));\n    }\n  }, [searchQuery]);\n\n\n  useEffect(() => {\n    if (currentPage !== 1) {\n      window.localStorage.setItem('currentPage', JSON.stringify(currentPage));\n    };\n  }, [currentPage]);\n\n\n  useEffect(() => {\n    if (articles.length > 0) {\n      window.localStorage.setItem('articles', JSON.stringify(articles));\n    }\n  }, [articles]);\n\n  // ! -------------------------------------------- LOCAL STORAGE ---------------------------------\n\n  const updatePage = () => {\n    setCurrentPage(prevPage => prevPage + 1);\n  };\n\n  const onChangeQuery = query => {\n    setSearchQuery(query);\n    setCurrentPage(1);\n    setArticles([]);\n  };\n\n  const shouldRenderLoadMoreButton = articles.length > 0 && status === 'resolved';\n\n  return (\n    <themeContext.Consumer>\n    {({mainTheme}) => (  \n    <NewsContainer colors={mainTheme.colors}>\n    <h1>News By Hooks</h1>\n      {status === 'idle' && <Idle />}\n      {status === 'rejected' && <Rejected />}\n      <NewSearchFormHooks onSubmit={onChangeQuery} />\n      {status === 'resolved' && <Resolved articles={articles} shouldRenderLoadMoreButton={shouldRenderLoadMoreButton} onClick={updatePage} />}\n      {status === 'pending' && <Pending />}\n    </NewsContainer>\n      )}\n      </themeContext.Consumer>      \n  );\n};\n\nexport function News() {\n  return (\n    <div style={{display: 'flex', justifyContent: 'space-between'}}>\n      <NewsClass />\n      <NewsHooks />\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}